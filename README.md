I did have some trouble at first. ChatGPT helped me to get on the correct track which is why the first macro is separated by steps. 
The code is what we used in class.
I used ChatGPT for corrections when I could not figure out an error.
